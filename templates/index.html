<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ReportGenie - Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #f8f9fa;
      padding-top: 50px;
    }
    .container {
      max-width: 1200px;
    }
    h1 {
      font-size: 28px;
      font-weight: bold;
      color: #495057;
    }
    .btn-create {
      background-color: #4c7488;
      border-color: #4c7488;
      color: #fff;
    }
    .btn-create:hover {
      background-color: #3b5b6e;
      border-color: #3b5b6e;
    }
    .btn-settings {
      background-color: #6c757d;
      border-color: #6c757d;
      color: #fff;
    }
    .btn-settings:hover {
      background-color: #5a6268;
      border-color: #5a6268;
    }
    .btn-action {
      margin-right: 5px;
    }
  </style>
</head>
<body>

<div class="container">
  <!-- Header Section -->
  <header class="d-flex justify-content-between align-items-center mb-4">
    <h1><img src="favicon.ico" width="50" /> ReportGenie Dashboard</h1>
    <div>
      <a href="/generate" class="btn btn-create me-2">Create New Project</a>
      <button type="button" class="btn btn-settings" id="settings-btn">Settings</button>
    </div>
  </header>

  <!-- Existing Projects List Section -->
  <div class="card mb-4">
    <div class="card-body">
      <h2>Old Projects</h2>
      <!-- Search and Filter Options -->
      <div class="row mb-3">
        <div class="col-md-6">
          <input type="text" class="form-control" id="searchProjects" placeholder="Search projects by name...">
        </div>
        <div class="col-md-3">
          <select class="form-select" id="filterStatus">
            <option value="">Filter by Status...</option>
            <option value="In Progress">In Progress</option>
            <option value="Completed">Completed</option>
          </select>
        </div>
        <div class="col-md-3">
          <select class="form-select" id="sortProjects">
            <option value="">Sort by...</option>
            <option value="name">Name</option>
            <option value="date">Start Date</option>
            <option value="status">End Date</option>
          </select>
        </div>
      </div>

      <!-- Projects Table -->
      <table class="table table-bordered" id="projectsTable" style="display: none;">
        <thead>
          <tr>
            <th>Project Name</th>
            <th>Date of Test</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <!-- Projects will be added dynamically here -->
        </tbody>
      </table>
      <!-- Empty State -->
      <div id="noProjectsMessage">
        <p>Looks like you don't have any projects yet. Let's get started and <a href="/generate">create</a> your first one!</p>
      </div>
    </div>
  </div>
</div>

<script>
    fetch('/projects')
      .then(response => response.json())
      .then(data => {
        const projectsTable = document.getElementById('projectsTable');
        const projectsTableBody = projectsTable.querySelector('tbody');
        const noProjectsMessage = document.getElementById('noProjectsMessage');
        
        if (data.length > 0) {
          noProjectsMessage.style.display = 'none';
          projectsTable.style.display = 'table';

          data.forEach((project, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${project.project_name}</td>
              <td>${project.start_date}</td>
              <td>${project.end_date}</td>
              <td>
                <a href="/edit?project_id=${project.project_id}" class="btn btn-primary btn-action" role="button">Edit</a>
                <a href="#link" class="btn btn-success btn-action" role="button">Download Report</a>
                <a href="/delete?project_id=${project.project_id}" class="btn btn-danger btn-action" role="button">Delete</a>
              </td>
            `;
            projectsTableBody.appendChild(row);
          });
        } else {
          noProjectsMessage.style.display = 'block';
        }
      })
      .catch(error => {
        console.error('Error fetching projects:', error);
      });
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
