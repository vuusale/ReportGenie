<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Penetration Test Report Generator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #f8f9fa;
      padding-top: 50px;
    }
    .container {
      max-width: 800px;
      background-color: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    h1 {
      font-size: 24px;
      font-weight: bold;
      color: #495057;
    }
    .form-label {
      font-weight: bold;
    }
    .form-control, .form-select {
      margin-bottom: 15px;
    }
    .btn-submit {
      background-color: #4c7488;
      border-color: #4c7488;
      color: #fff;
    }
    .btn-submit:hover {
      background-color: #3b5b6e;
      border-color: #3b5b6e;
    }
    .btn-add-vuln {
      background-color: #28a745;
      border-color: #28a745;
      color: #fff;
    }
    .btn-add-vuln:hover {
      background-color: #218838;
      border-color: #218838;
    }
    .btn-remove-vuln {
      background-color: #dc3545;
      border-color: #dc3545;
      color: #fff;
    }
    .btn-remove-vuln:hover {
      background-color: #c82333;
      border-color: #c82333;
    }
  </style>
</head>
<body>

<div class="container">
  <h1>Penetration Testing Report</h1>
  <form method="POST" action="/generate-report">
    <input type="hidden" class="form-control" id="vulnCount" name="vulnCount" required value="1">
    <!-- Project Details -->
    <div class="mb-3">
      <label for="projectName" class="form-label">Project Name</label>
      <input type="text" class="form-control" id="projectName" name="projectName" required>
    </div>

    <div class="mb-3">
      <label for="reporterName" class="form-label">Reporter Name</label>
      <input type="text" class="form-control" id="reporterName" name="reporterName" required>
    </div>

    <div class="mb-3">
      <label for="testDate" class="form-label">Date of Test</label>
      <input type="date" class="form-control" id="testDate" name="testDate" required>
    </div>

    <!-- Vulnerability Forms Container -->
    <div id="vuln-forms">
      <h2>Vulnerabilities</h2>
      <div class="vuln-form" id="vuln-form-1">
        <h5>Vulnerability 1</h5>
        <div class="mb-3">
          <label for="vulnerabilityTitle-1" class="form-label">Vulnerability Title</label>
          <input type="text" class="form-control" id="vulnerabilityTitle-1" name="vulnerabilityTitle-1" required>
        </div>

        <div class="mb-3">
          <label for="severity-1" class="form-label">Severity</label>
          <select class="form-select" id="severity-1" name="severity-1" required>
            <option value="">Choose...</option>
            <option value="Low">Low</option>
            <option value="Medium">Medium</option>
            <option value="High">High</option>
            <option value="Critical">Critical</option>
          </select>
        </div>

        <div class="mb-3">
          <label for="description-1" class="form-label">Description</label>
          <textarea class="form-control" id="description-1" name="description-1" rows="4" required></textarea>
        </div>

        <div class="mb-3">
          <label for="impact-1" class="form-label">Impact</label>
          <textarea class="form-control" id="impact-1" name="impact-1" rows="4" required></textarea>
        </div>

        <div class="mb-3">
          <label for="remediation-1" class="form-label">Remediation</label>
          <textarea class="form-control" id="remediation-1" name="remediation-1" rows="4" required></textarea>
        </div>
        <button type="button" class="btn btn-remove-vuln" onclick="removeVuln(1)" style="display: none;">Remove</button>
      </div>
    </div>

    <!-- Add Vulnerability Button -->
    <div class="d-grid gap-2">
      <button type="button" class="btn btn-add-vuln btn-lg" id="add-vuln-btn">Add Vulnerability</button>
    </div>

    <!-- Submit Button -->
    <div class="d-grid gap-2 mt-4">
      <button type="submit" class="btn btn-submit btn-lg">Generate Report</button>
    </div>
  </form>
</div>

<script>
  let vulnCount = 1;
  
  // Function to add a new vulnerability form
  document.getElementById('add-vuln-btn').addEventListener('click', function () {
    vulnCount++;
    document.getElementById("vulnCount").value = vulnCount;
    const vulnFormsContainer = document.getElementById('vuln-forms');

    const newVulnForm = `
      <div class="vuln-form" id="vuln-form-${vulnCount}">
        <h5>Vulnerability ${vulnCount}</h5>
        <div class="mb-3">
          <label for="vulnerabilityTitle-${vulnCount}" class="form-label">Vulnerability Title</label>
          <input type="text" class="form-control" id="vulnerabilityTitle-${vulnCount}" name="vulnerabilityTitle[]" required>
        </div>

        <div class="mb-3">
          <label for="severity-${vulnCount}" class="form-label">Severity</label>
          <select class="form-select" id="severity-${vulnCount}" name="severity-${vulnCount}" required>
            <option value="">Choose...</option>
            <option value="Low">Low</option>
            <option value="Medium">Medium</option>
            <option value="High">High</option>
            <option value="Critical">Critical</option>
          </select>
        </div>

        <div class="mb-3">
          <label for="description-${vulnCount}" class="form-label">Description</label>
          <textarea class="form-control" id="description-${vulnCount}" name="description[${vulnCount}]" rows="4" required></textarea>
        </div>

        <div class="mb-3">
          <label for="impact-${vulnCount}" class="form-label">Impact</label>
          <textarea class="form-control" id="impact-${vulnCount}" name="impact[${vulnCount}]" rows="4" required></textarea>
        </div>

        <div class="mb-3">
          <label for="remediation-${vulnCount}" class="form-label">Remediation</label>
          <textarea class="form-control" id="remediation-${vulnCount}" name="remediation[${vulnCount}]" rows="4" required></textarea>
        </div>

        <button type="button" class="btn btn-remove-vuln" onclick="removeVuln(${vulnCount})">Remove</button>
      </div>
    `;

    vulnFormsContainer.insertAdjacentHTML('beforeend', newVulnForm);
    updateRemoveButtonVisibility();
  });

  // Function to remove a vulnerability form
  function removeVuln(vulnId) {
    const vulnForm = document.getElementById(`vuln-form-${vulnId}`);
    if (vulnForm) {
      vulnForm.remove();
      vulnCount--;
      document.getElementById("vulnCount").value = vulnCount;
      
      // Update titles of remaining vulnerability forms
      const remainingVulnForms = document.getElementsByClassName('vuln-form');
      for (let i = 0; i < remainingVulnForms.length; i++) {
        const form = remainingVulnForms[i];
        const newIndex = i + 1;
        form.id = `vuln-form-${newIndex}`;
        form.querySelector('h5').innerText = `Vulnerability ${newIndex}`;
        form.querySelectorAll('label').forEach(label => {
          const labelFor = label.getAttribute('for');
          if (labelFor) {
            const newFor = labelFor.replace(/-\d+$/, `-${newIndex}`);
            label.setAttribute('for', newFor);
          }
        });
        form.querySelectorAll('input, select, textarea').forEach(input => {
          const inputId = input.getAttribute('id');
          if (inputId) {
            const newId = inputId.replace(/-\d+$/, `-${newIndex}`);
            input.setAttribute('id', newId);
          }
          const inputName = input.getAttribute('name');
          if (inputName && inputName.includes('[')) {
            const newName = inputName.replace(/\[\d+\]/, `[${newIndex}]`);
            input.setAttribute('name', newName);
          }
        });
      }
      updateRemoveButtonVisibility();
    }
  }

  // Function to update the visibility of remove buttons
  function updateRemoveButtonVisibility() {
    const removeButtons = document.querySelectorAll('.btn-remove-vuln');
    if (vulnCount > 1) {
      removeButtons.forEach(button => {
        button.style.display = 'inline-block';
      });
    } else {
      removeButtons.forEach(button => {
        button.style.display = 'none';
      });
    }
  }

  // Initial call to set remove button visibility
  updateRemoveButtonVisibility();
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
</body
